(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{489:(e,r,t)=>{"use strict";t.d(r,{nc:()=>l,Wn:()=>i}),t(7652);var a=t(5453),s=t(4309);let l=(0,a.v)((e,r)=>({user:null,accessToken:null,refreshToken:null,setSession:(r,t)=>{t&&(s.HM.setAccess(t),localStorage.setItem("token",t)),e({user:r,accessToken:t,refreshToken:null})},clearSession:()=>{s.HM.clearAccess(),s.HM.clearRefresh(),localStorage.removeItem("token"),t.e(135).then(t.bind(t,9135)).then(e=>{e.useCartStore.getState().clearUserData()}),t.e(628).then(t.bind(t,3628)).then(e=>{e.useLikeStore.getState().clearUserData()}),e({user:null,accessToken:null,refreshToken:null})},isAuthed:()=>!!(r().user||s.HM.getAccess())}));{let e=localStorage.getItem("token");e&&l.setState({accessToken:e})}var o=t(5695);function i(){let e=l(e=>e.clearSession),r=(0,o.useRouter)();return()=>{e(),r.push("/login")}}},858:(e,r,t)=>{Promise.resolve().then(t.bind(t,6616))},3628:(e,r,t)=>{"use strict";t.r(r),t.d(r,{useLikeStore:()=>o});var a=t(5453),s=t(6786),l=t(3568);let o=(0,a.v)()((0,s.Zr)((e,r)=>({items:[],requireAuth:e=>!!localStorage.getItem("token")||(null==e||e(),!1),addToLikes:async(t,a)=>{if(r().requireAuth(a))try{await (0,l.yV)(t.id,t.selectedColor,t.selectedSize),e(e=>e.items.find(e=>e.id===t.id&&e.selectedColor===t.selectedColor&&e.selectedSize===t.selectedSize)?e:{items:[...e.items,t]})}catch(r){console.error("Add to favorites failed:",r),e(e=>e.items.find(e=>e.id===t.id&&e.selectedColor===t.selectedColor&&e.selectedSize===t.selectedSize)?e:{items:[...e.items,t]})}},removeFromLikes:async(r,t,a)=>{try{await (0,l.Op)(r,t,a)}catch(e){console.error("Remove from favorites failed:",e)}e(e=>({items:e.items.filter(e=>e.id!==r||e.selectedColor!==t||e.selectedSize!==a)}))},clearLikes:()=>{e({items:[]})},clearUserData:()=>{e({items:[]})},loadUserFavorites:async()=>{if(r().requireAuth())try{let r=await (0,l.bW)();e({items:r||[]})}catch(e){console.error("Load user favorites failed:",e)}},getTotalItems:()=>localStorage.getItem("token")?r().items.length:0,isItemLiked:(e,t,a)=>r().items.some(r=>r.id===e&&r.selectedColor===t&&r.selectedSize===a)}),{name:(e=>{{let r=localStorage.getItem("token");if(r)try{let t=JSON.parse(atob(r.split(".")[1]));return"".concat(e,"-").concat(t.sub||t.id||"anonymous")}catch(e){}}return"".concat(e,"-anonymous")})("shopease-likes"),storage:(0,s.KU)(()=>localStorage)}))},4309:(e,r,t)=>{"use strict";t.d(r,{rO:()=>s,FH:()=>l,GT:()=>i,HM:()=>o});var a=t(3464);let s={favorites:"/api/User/Favorites",cart:"/api/User/Cart",addToFavorites:"/api/User/Favorites/Add",removeFromFavorites:"/api/User/Favorites/Remove",addToCart:"/api/User/Cart/Add",removeFromCart:"/api/User/Cart/Remove",updateCartQuantity:"/api/User/Cart/Update"},l=a.A.create({baseURL:"https://eticaretapi-gghdgef9bzameteu.switzerlandnorth-01.azurewebsites.net/api",withCredentials:!1,headers:{"Content-Type":"application/json",Accept:"application/json"}});l.interceptors.request.use(e=>{let r=localStorage.getItem("token");if(r){var t;e.headers=null!=(t=e.headers)?t:{},e.headers.Authorization="Bearer ".concat(r)}return e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,e=>{var r;return(null==(r=e.response)?void 0:r.status)===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)});let o={getAccess:()=>localStorage.getItem("token"),setAccess:e=>{localStorage.setItem("token",e)},clearAccess:()=>{localStorage.removeItem("token")},getRefresh:()=>null,setRefresh:()=>{},clearRefresh:()=>{}},i=e=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(e)},5695:(e,r,t)=>{"use strict";var a=t(8999);t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}})},6616:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>m});var a=t(5155),s=t(2115),l=t(5695),o=t(6874),i=t.n(o),n=t(7652),c=t(489),d=t(9135),u=t(3628);function m(){let e=(0,l.useRouter)(),r=(0,c.nc)(e=>e.setSession),t=(0,d.useCartStore)(e=>e.loadUserCart),o=(0,u.useLikeStore)(e=>e.loadUserFavorites),[m,h]=(0,s.useState)({firstName:"",lastName:"",phoneNumber:"",email:"",password:"",dateOfBirth:"",gender:0}),[p,f]=(0,s.useState)(!1),[g,v]=(0,s.useState)(null),k=async a=>{if(a.preventDefault(),f(!0),v(null),!/^\S+@\S+\.\S+$/.test(m.email)){v("L\xfctfen ge\xe7erli bir e‑posta giriniz."),f(!1);return}if(m.password.length<7){v("Şifre en az 7 karakter olmalıdır."),f(!1);return}let s=/[A-Z]/.test(m.password),l=/[!@#$%^&*(),.?":{}|<>]/.test(m.password);if(!s){v("Şifre en az bir b\xfcy\xfck harf i\xe7ermelidir."),f(!1);return}if(!l){v("Şifre en az bir \xf6zel karakter i\xe7ermelidir (!@#$%^&* gibi)."),f(!1);return}if(!/^\+?\d{10,15}$/.test(m.phoneNumber.replace(/\s/g,""))){v("L\xfctfen ge\xe7erli bir telefon numarası giriniz (10‑15 haneli)."),f(!1);return}if(!m.dateOfBirth){v("L\xfctfen doğum tarihinizi se\xe7iniz."),f(!1);return}try{let a=await (0,n.UB)(m);if(console.log("Register result:",a),a.success){var i,c,d,u;if(null==(i=a.token)?void 0:i.accessToken){localStorage.setItem("token",a.token.accessToken);let s={id:a.userId||"",email:m.email,firstName:(null==(c=a.user)?void 0:c.firstName)||m.firstName,lastName:(null==(d=a.user)?void 0:d.lastName)||m.lastName,roles:(null==(u=a.user)?void 0:u.roles)||[]};r(s,a.token.accessToken);try{await Promise.all([t(),o()])}catch(e){console.error("Failed to load user data:",e)}e.push("/account")}else alert("Kayıt başarılı! Şimdi giriş yapabilirsiniz."),e.push("/login")}else v(a.message||"Register failed")}catch(e){v(function(e){var r,t,a,s,l,o,i,n,c,d,u,m,h,p,f;let g=null!=(f=null!=(p=null!=(h=null!=(m=null!=(u=null==e||null==(t=e.response)||null==(r=t.data)?void 0:r.message)?u:null==e||null==(s=e.response)||null==(a=s.data)?void 0:a.error)?m:null==e?void 0:e.message)?h:null==e||null==(o=e.response)||null==(l=o.data)?void 0:l.title)?p:null==e||null==(n=e.response)||null==(i=n.data)?void 0:i.detail)?f:"",v=null==e||null==(d=e.response)||null==(c=d.data)?void 0:c.errors;if(v&&"object"==typeof v){let e=Object.keys(v)[0],r=e?v[e]:void 0;if(Array.isArray(r)&&r.length>0)return r[0]}return g||"Kayıt başarısız. L\xfctfen bilgilerinizi kontrol edin."}(e))}finally{f(!1)}};return(0,a.jsxs)("div",{className:"container max-w-md py-12",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Kayıt Ol"}),(0,a.jsxs)("form",{onSubmit:k,className:"space-y-4",children:[(0,a.jsx)("input",{type:"text",placeholder:"Ad",className:"w-full border p-3 rounded",value:m.firstName,onChange:e=>h({...m,firstName:e.target.value}),required:!0}),(0,a.jsx)("input",{type:"text",placeholder:"Soyad",className:"w-full border p-3 rounded",value:m.lastName,onChange:e=>h({...m,lastName:e.target.value}),required:!0}),(0,a.jsx)("input",{type:"email",placeholder:"E-posta",className:"w-full border p-3 rounded",value:m.email,onChange:e=>h({...m,email:e.target.value}),required:!0}),(0,a.jsx)("input",{type:"password",placeholder:"Şifre",className:"w-full border p-3 rounded",value:m.password,onChange:e=>h({...m,password:e.target.value}),required:!0,minLength:7}),(0,a.jsxs)("div",{className:"bg-blue-50 p-3 rounded text-sm",children:[(0,a.jsx)("p",{className:"font-semibold mb-2",children:"Şifre gereksinimleri:"}),(0,a.jsxs)("ul",{className:"text-xs space-y-1",children:[(0,a.jsx)("li",{className:m.password.length>=7?"text-green-600":"text-gray-600",children:"✓ En az 7 karakter"}),(0,a.jsx)("li",{className:/[A-Z]/.test(m.password)?"text-green-600":"text-gray-600",children:"✓ En az bir b\xfcy\xfck harf (A-Z)"}),(0,a.jsx)("li",{className:/[!@#$%^&*(),.?":{}|<>]/.test(m.password)?"text-green-600":"text-gray-600",children:"✓ En az bir \xf6zel karakter (!@#$%^&* gibi)"})]})]}),(0,a.jsx)("input",{type:"tel",placeholder:"Telefon (\xf6rn: 05551234567 veya +905551234567)",className:"w-full border p-3 rounded",value:m.phoneNumber,onChange:e=>h({...m,phoneNumber:e.target.value}),required:!0}),(0,a.jsx)("input",{type:"date",placeholder:"Doğum Tarihi",className:"w-full border p-3 rounded",value:m.dateOfBirth,onChange:e=>h({...m,dateOfBirth:e.target.value}),required:!0}),(0,a.jsxs)("select",{className:"w-full border p-3 rounded",value:m.gender,onChange:e=>h({...m,gender:Number(e.target.value)}),required:!0,children:[(0,a.jsx)("option",{value:0,children:"Erkek"}),(0,a.jsx)("option",{value:1,children:"Kadın"}),(0,a.jsx)("option",{value:2,children:"Diğer"})]}),g&&(0,a.jsx)("p",{className:"text-red-600 text-sm",children:g}),(0,a.jsx)("button",{type:"submit",disabled:p,className:"w-full bg-black text-white py-3 rounded hover:bg-gray-800",children:p?"G\xf6nderiliyor...":"Kayıt Ol"})]}),(0,a.jsxs)("p",{className:"mt-4 text-sm",children:["Zaten hesabın var mı? ",(0,a.jsx)(i(),{href:"/login",className:"underline",children:"Giriş yap"})]})]})}},7652:(e,r,t)=>{"use strict";t.d(r,{MI:()=>y,UB:()=>w});var a=t(4309);let{Axios:s,AxiosError:l,CanceledError:o,isCancel:i,CancelToken:n,VERSION:c,all:d,Cancel:u,isAxiosError:m,spread:h,toFormData:p,AxiosHeaders:f,HttpStatusCode:g,formToJSON:v,getAdapter:k,mergeConfig:b}=t(3464).A,y=async(e,r)=>{try{let t=await a.FH.post("/Auth/login",{email:e,password:r});if(!t.data.success)throw Error(t.data.message||"Login failed");return t.data}catch(e){if(console.error("Login API Error:",e),e instanceof l){var t,s;if(null==(s=e.response)||null==(t=s.data)?void 0:t.message)throw Error(e.response.data.message)}if(e instanceof Error)throw Error(e.message||"Network error occurred");throw Error("Network error occurred")}},w=async e=>{try{let r=await a.FH.post("/Auth/register",e);if(!r.data.success)throw Error(r.data.message||"Register failed");return r.data}catch(e){if(console.error("Register API Error:",e),e instanceof l){var r,t;if(null==(t=e.response)||null==(r=t.data)?void 0:r.message)throw Error(e.response.data.message)}if(e instanceof Error)throw Error(e.message||"Network error occurred");throw Error("Network error occurred")}}}},e=>{e.O(0,[873,135,441,964,358],()=>e(e.s=858)),_N_E=e.O()}]);